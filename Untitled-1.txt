using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using System;
using System.Threading;
using System.Collections;

public class Script1 : MonoBehaviour
{
    public Text scoreText;
    public Button[] upgradebuttons;
    public GameObject upgradepan;
    public float[] PrayTime;
    private int score;
    private int bonus = 1;
    public int priestscount, priestbonus = 1;


    public int[] upgradeCosts;
    public int[] upgradeBonuses;
    public Text[] upgradebttnstext;
    public Text[] informationtext;

    private void Start()
    {
        StartCoroutine(Bonuspersec());
    }
    private void Update()
    {
        scoreText.text = score + "$";
    }
    public void upgrade()
    {
        upgradepan.SetActive(!upgradepan.activeSelf);
    }
    public void upgradepanplusbonus(int index)
    {
        if (score >= upgradeCosts[index])
        {
            bonus += upgradeBonuses[index];
            score -= upgradeCosts[index];
            upgradeCosts[index] *= 2;
            upgradebttnstext[index].text = "Lvlup\n" + upgradeCosts[index] + "$";
        }
         else
        {
            StartCoroutine(AnonceTimer(informationtext[index], index));
        }

    }

    public void Hirepriest(int index)
    {
        if (score >= upgradeCosts[index])
        {
            priestscount++;
            score -= upgradeCosts[index];
            upgradeCosts[index] *= 2;
            upgradebttnstext[index].text = "Hirepriest\n" + upgradeCosts[index] + "$";
            }
     }

    public void startPraytimer(int index)
    {

        int cost = 3 * priestscount;
        if (priestscount > 0)
            upgradebttnstext[2].text = "Pray\n" + cost + "$";
        score -= cost;
        if (score >= cost)
        {
            StartCoroutine(PrayTimer(PrayTime[index], index));
        }
    }

    IEnumerator Bonuspersec()
    {
        while (true)
        {
            score += (priestscount * priestbonus);
            yield return new WaitForSeconds(1);
        }

    }

    IEnumerator PrayTimer(float timer, int index)
    {
        upgradebuttons[index].interactable = false;
        if (index == 0 && priestscount > 0)
        {
            priestbonus *= 3;
            yield return new WaitForSeconds(timer);
            priestbonus /= 3;
        }

        upgradebuttons[index].interactable = true;
    }
    
     IEnumerator AnonceTimer(float timer, int index)
        {
            informationtext[index].setActive;
            yield return new WaitForSeconds(timer);
            informationtext[index].activeSelf; // можливо це не нада
        }
    
    public void OnClick()
    {
        score += bonus;

    }
    
}
